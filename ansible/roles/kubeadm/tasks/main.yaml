---
- name: Install runc (OCI runtime)
  ansible.builtin.include_role:
    name: githubixx.runc

- name: Install containerd
  ansible.builtin.include_role:
    name: githubixx.containerd

- name: Create containerd conf.d directory
  ansible.builtin.file:
    path: /etc/containerd/conf.d
    state: directory
    mode: "0755"

- name: Include common tasks
  ansible.builtin.include_tasks: common.yaml
- name: Include iscsi tasks
  ansible.builtin.include_tasks: iscsi.yaml
- name: Configure NVIDIA GPU support
  ansible.builtin.include_tasks: nvidia.yaml
  when: kubeadm_nvidia_gpu | default(false)
- name: Include master tasks
  ansible.builtin.include_tasks: master.yaml
  when: is_kubernetes_master
- name: Include node tasks
  ansible.builtin.include_tasks: nodes.yaml
  when: is_kubernetes_node
