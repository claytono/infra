# Network interface settings; autogenerated
# PVE will preserve source directives, but will NOT read its network
# configuration from sourced files.

auto lo
iface lo inet loopback

{% for interface in proxmox_interfaces %}
iface {{ interface.name }} inet {{ interface.type }}
{% if interface.comment is defined %}	# {{ interface.comment }}
{% endif %}

{% endfor %}
{% for bridge in proxmox_bridges %}
auto {{ bridge.name }}
iface {{ bridge.name }} inet static
{% if bridge.address is defined %}	address {{ bridge.address }}
{% endif %}
{% if bridge.gateway is defined %}	gateway {{ bridge.gateway }}
{% endif %}
	bridge-ports {{ bridge.bridge_ports }}
	bridge-stp {{ bridge.bridge_stp }}
	bridge-fd {{ bridge.bridge_fd }}
{% if bridge.bridge_vlan_aware is defined %}	bridge-vlan-aware {{ bridge.bridge_vlan_aware }}
{% endif %}
{% if bridge.bridge_vids is defined %}	bridge-vids {{ bridge.bridge_vids }}
{% endif %}
{% if bridge.comment is defined %}	# {{ bridge.comment }}
{% endif %}
{% if bridge.address is defined and host_ipv4 is defined %}
iface {{ bridge.name }} inet6 static
	address {{ infrastructure_ipv6_prefix }}::74:{{ host_ipv4.split('.')[3] }}/{{ infrastructure_ipv6_netmask }}
	gateway {{ infrastructure_ipv6_gateway }}
{% endif %}

{% endfor %}
source /etc/network/interfaces.d/*
