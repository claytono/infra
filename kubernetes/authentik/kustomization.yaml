---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: authentik

resources:
- namespace.yaml
- externalsecret.yaml
- authentik-postgres-cluster.yaml
# Authentik resources
- helm/authentik/secret.yaml
- helm/authentik/server/deployment.yaml
- helm/authentik/server/ingress.yaml
- helm/authentik/server/service.yaml
- helm/authentik/worker/deployment.yaml
- helm/authentik/serviceAccount/templates/serviceaccount.yaml
- helm/authentik/serviceAccount/templates/clusterrole.yaml
- helm/authentik/serviceAccount/templates/clusterrolebinding.yaml
- helm/authentik/serviceAccount/templates/role.yaml
- helm/authentik/serviceAccount/templates/rolebinding.yaml
# Valkey resources
- helm/valkey/pvc.yaml
- helm/valkey/scripts.yaml
- helm/valkey/service-internal.yaml
- helm/valkey/services.yaml
- helm/valkey/statefulset.yaml
# Traefik forward-auth middlewares
- middleware-forward-auth-simple.yaml
- middleware-forward-auth-basic.yaml

commonAnnotations:
  argoManaged: 'true'
