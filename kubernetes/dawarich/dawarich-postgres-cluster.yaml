---
apiVersion: postgresql.cnpg.io/v1
kind: Cluster

metadata:
  name: dawarich-postgres

spec:
  instances: 1
  imageName: ghcr.io/cloudnative-pg/postgis:17.7-3.6.1-standard-trixie@sha256:168efc33d74d2aacc3e6a4793e6a3e812d6d4c193ec292274d655eed242d8755
  enablePDB: false

  storage:
    size: 20Gi

  managed:
    roles:
    - name: dawarich
      ensure: present
      login: true
      superuser: false
      createdb: false
      createrole: false
      inherit: true
      replication: false
      bypassrls: false
      connectionLimit: -1
      # Grant permission to create extensions
      inRoles:
      - pg_create_extension

  bootstrap:
    initdb:
      database: dawarich
      owner: dawarich
      postInitTemplateSQL:
      - CREATE EXTENSION IF NOT EXISTS postgis
