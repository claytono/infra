---
apiVersion: apps/v1
kind: Deployment

metadata:
  name: ddns-route53
  annotations:
    reloader.stakater.com/auto: 'true'

spec:
  replicas: 1
  strategy:
    type: Recreate
  selector:
    matchLabels:
      app.kubernetes.io/name: ddns-route53
      app.kubernetes.io/instance: ddns-route53
  template:
    metadata:
      name: ddns-route53
      labels:
        app.kubernetes.io/name: ddns-route53
        app.kubernetes.io/instance: ddns-route53
    spec:
      containers:
      - name: oneill
        image: ghcr.io/crazy-max/ddns-route53:2.13.0@sha256:d10e583abf0f5665217d557d8cafb9806e6fb079b7d255b516fe1f5dbf90a1b3
        args:
        - --schedule=*/5 * * * *
        securityContext:
          allowPrivilegeEscalation: false
          runAsNonRoot: true
          runAsUser: 1000
          seccompProfile:
            type: RuntimeDefault
        env:
        - name: DDNSR53_CREDENTIALS_ACCESSKEYID
          valueFrom:
            secretKeyRef:
              name: ddns-route53-aws
              key: DDNSR53_CREDENTIALS_ACCESSKEYID
        - name: DDNSR53_CREDENTIALS_SECRETACCESSKEY
          valueFrom:
            secretKeyRef:
              name: ddns-route53-aws
              key: DDNSR53_CREDENTIALS_SECRETACCESSKEY
        - name: DDNSR53_ROUTE53_HOSTEDZONEID
          valueFrom:
            secretKeyRef:
              name: ddns-route53-aws
              key: ONEILL_NET_ZONE_ID
        - name: DDNSR53_ROUTE53_RECORDSSET_0_NAME
          value: luser.oneill.net.
        - name: DDNSR53_ROUTE53_RECORDSSET_0_TYPE
          value: A
        - name: DDNSR53_ROUTE53_RECORDSSET_0_TTL
          value: '300'
        - name: DDNSR53_ROUTE53_RECORDSSET_1_NAME
          value: luser.oneill.net.
        - name: DDNSR53_ROUTE53_RECORDSSET_1_TYPE
          value: AAAA
        - name: DDNSR53_ROUTE53_RECORDSSET_1_TTL
          value: '300'
      - name: fnord
        image: ghcr.io/crazy-max/ddns-route53:2.13.0@sha256:d10e583abf0f5665217d557d8cafb9806e6fb079b7d255b516fe1f5dbf90a1b3
        args:
        - --schedule=*/5 * * * *
        securityContext:
          allowPrivilegeEscalation: false
          runAsNonRoot: true
          runAsUser: 1000
          seccompProfile:
            type: RuntimeDefault
        env:
        - name: DDNSR53_CREDENTIALS_ACCESSKEYID
          valueFrom:
            secretKeyRef:
              name: ddns-route53-aws
              key: DDNSR53_CREDENTIALS_ACCESSKEYID
        - name: DDNSR53_CREDENTIALS_SECRETACCESSKEY
          valueFrom:
            secretKeyRef:
              name: ddns-route53-aws
              key: DDNSR53_CREDENTIALS_SECRETACCESSKEY
        - name: DDNSR53_ROUTE53_HOSTEDZONEID
          valueFrom:
            secretKeyRef:
              name: ddns-route53-aws
              key: FNORD_NET_ZONE_ID
        - name: DDNSR53_ROUTE53_RECORDSSET_0_NAME
          value: luser.fnord.net.
        - name: DDNSR53_ROUTE53_RECORDSSET_0_TYPE
          value: A
        - name: DDNSR53_ROUTE53_RECORDSSET_0_TTL
          value: '300'
        - name: DDNSR53_ROUTE53_RECORDSSET_1_NAME
          value: luser.fnord.net.
        - name: DDNSR53_ROUTE53_RECORDSSET_1_TYPE
          value: AAAA
        - name: DDNSR53_ROUTE53_RECORDSSET_1_TTL
          value: '300'
