---
# Source: descheduler/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: descheduler
  namespace: default
  labels:
    app.kubernetes.io/name: descheduler
    app.kubernetes.io/instance: descheduler
    app.kubernetes.io/version: "0.34.0"
    app.kubernetes.io/managed-by: Helm
data:
  policy.yaml: |
    apiVersion: "descheduler/v1alpha2"
    kind: "DeschedulerPolicy"
    evictLocalStoragePods: true
    maxNoOfPodsToEvictPerNamespace: 1
    profiles:
    - name: default
      pluginConfig:
      - args:
          evictLocalStoragePods: true
          labelSelector:
            matchExpressions:
            - key: job-name
              operator: DoesNotExist
        name: DefaultEvictor
      - args:
          maxPodLifeTimeSeconds: 1209600
          states:
          - Running
        name: PodLifeTime
      - args:
          includingInitContainers: true
          podRestartThreshold: 10
        name: RemovePodsHavingTooManyRestarts
      plugins:
        deschedule:
          enabled:
          - PodLifeTime
          - RemovePodsHavingTooManyRestarts
    - name: frank-daily-restart
      pluginConfig:
      - args:
          evictLocalStoragePods: true
        name: DefaultEvictor
      - args:
          maxPodLifeTimeSeconds: 86400
          namespaces:
            include:
            - frank
          states:
          - Running
        name: PodLifeTime
      plugins:
        deschedule:
          enabled:
          - PodLifeTime
