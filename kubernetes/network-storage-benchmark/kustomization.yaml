---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: network-storage-benchmark

images:
- name: alpine
  newTag: "3.22@sha256:4b7ce07002c69e8f3d704a9c5d6fd3053be500b7f1c69fc0d80990c2ad8dd412"

resources:
- namespace.yaml
- pvc-iscsi.yaml
- pvc-nfs.yaml
- pvc-nfs-slow.yaml
- pvc-results.yaml

# Network and storage benchmark resources are deployed by run-benchmark.sh

configMapGenerator:
- name: fio-jobs
  options:
    disableNameSuffixHash: true
  files:
  - seq-read.fio=fio-jobs/seq-read.fio
  - seq-write.fio=fio-jobs/seq-write.fio
  - rand-4k-read.fio=fio-jobs/rand-4k-read.fio
  - rand-4k-write.fio=fio-jobs/rand-4k-write.fio
  - mixed-rw.fio=fio-jobs/mixed-rw.fio

- name: test-runner
  options:
    disableNameSuffixHash: true
  files:
  - run-storage-tests.py=scripts/run-storage-tests.py
  - cleanup-volume.sh=scripts/cleanup-volume.sh

- name: network-test
  options:
    disableNameSuffixHash: true
  files:
  - parse-results.py=scripts/parse-results.py
  - run-iperf-server.sh=scripts/run-iperf-server.sh
  - run-iperf-client.sh=scripts/run-iperf-client.sh
