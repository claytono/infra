---
apiVersion: external-secrets.io/v1
kind: ExternalSecret

metadata:
  name: openarchiver-secrets
  namespace: openarchiver

spec:
  secretStoreRef:
    name: production
    kind: ClusterSecretStore
  refreshPolicy: CreatedOnce
  target:
    name: openarchiver-secrets
    creationPolicy: Owner
    template:
      type: Opaque
  dataFrom:
  - rewrite:
    - regexp:
        source: password
        target: jwt-secret
    sourceRef:
      generatorRef:
        kind: Password
        name: openarchiver-jwt
  - rewrite:
    - regexp:
        source: password
        target: encryption-key
    sourceRef:
      generatorRef:
        kind: Password
        name: openarchiver-encryption
  - rewrite:
    - regexp:
        source: password
        target: redis-password
    sourceRef:
      generatorRef:
        kind: Password
        name: openarchiver-redis
  - rewrite:
    - regexp:
        source: password
        target: meilisearch-master-key
    sourceRef:
      generatorRef:
        kind: Password
        name: openarchiver-meilisearch
