---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: openarchiver

resources:
- namespace.yaml
- postgres-cluster.yaml
- password-generators.yaml
- externalsecret.yaml
- configmap.yaml
- pvc.yaml
- helm/valkey/pvc.yaml
- helm/valkey/scripts.yaml
- helm/valkey/service-internal.yaml
- helm/valkey/services.yaml
- helm/valkey/statefulset.yaml
- meilisearch-service.yaml
- meilisearch-statefulset.yaml
- service.yaml
- deploy.yaml
- ingress.yaml

patches:
- path: patch-valkey-secret-mount.yaml
  target:
    kind: Deployment
    name: valkey

commonAnnotations:
  argoManaged: 'true'
