---
# Source: mail/templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: smtp
  labels:
    app.kubernetes.io/name: mail
    app.kubernetes.io/instance: smtp
    app.kubernetes.io/version: "4.4.0"
    app.kubernetes.io/managed-by: Helm
data:
  ALLOWED_SENDER_DOMAINS: oneill.net k.oneill.net fnord.net
  RELAYHOST: '[smtp.gmail.com]:587'
  RELAYHOST_USERNAME: clayton.oneill@gmail.com
  POSTFIX_myhostname: "smtp.k.oneill.net"
  POSTFIX_mynetworks: "127.0.0.0/8 10.244.0.0/16 172.19.74.0/24 172.20.4.0/20"
  POSTFIX_smtp_tls_security_level: "encrypt"
  _enable_tls.sh: |
    #!/usr/bin/env bash
    set -e
    do_postconf -e 'smtp_use_tls=yes'
    do_postconf -e 'smtp_tls_note_starttls_offer=yes'
    do_postconf -e 'smtpd_use_tls=yes'
    do_postconf -e 'smtpd_tls_note_starttls_offer=yes'
    do_postconf -e 'smtpd_tls_cert_file=/var/run/certs/tls.crt'
    do_postconf -e 'smtpd_tls_key_file=/var/run/certs/tls.key'
